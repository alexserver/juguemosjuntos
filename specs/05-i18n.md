# Specification: Multilingual Product and Character Data

## Overview

This specification outlines the implementation of multilingual support for product and character data using nested language objects. This approach allows for different pricing per market and localized character names while maintaining a single source of truth.

## Objectives

1. Support multiple languages (ES/EN) for product names and pricing
2. Support multiple languages for character names
3. Allow different prices and currencies based on language/market
4. Maintain single source of truth for all data
5. Minimize code duplication

## Data Structure Changes

### 1. Products Data (`src/data/products.json`)

**Before:**
```json
[
  {
    "id": "halloween",
    "name": "Lotería de Halloween",
    "price": 120,
    "currency": "MXN"
  }
]
```

**After:**
```json
[
  {
    "id": "halloween",
    "name": {
      "es": "Lotería de Halloween",
      "en": "Halloween Lotería"
    },
    "price": {
      "es": {
        "amount": 120,
        "currency": "MXN"
      },
      "en": {
        "amount": 15,
        "currency": "USD"
      }
    }
  },
  {
    "id": "christmas",
    "name": {
      "es": "Lotería de Navidad",
      "en": "Christmas Lotería"
    },
    "price": {
      "es": {
        "amount": 120,
        "currency": "MXN"
      },
      "en": {
        "amount": 15,
        "currency": "USD"
      }
    }
  }
]
```

**Structure:**
- `id`: string - Unique product identifier (unchanged)
- `name`: object - Language-keyed product names
  - `es`: string - Spanish product name
  - `en`: string - English product name
- `price`: object - Language/market-keyed pricing
  - `es`: object - Pricing for Spanish market
    - `amount`: number - Price amount
    - `currency`: string - Currency code (ISO 4217)
  - `en`: object - Pricing for English market
    - `amount`: number - Price amount
    - `currency`: string - Currency code (ISO 4217)

### 2. Halloween Characters Data (`src/data/characters.json`)

**Before:**
```json
[
  {
    "id": 1,
    "name": "La Brujita",
    "filename": "01.png"
  }
]
```

**After:**
```json
[
  {
    "id": 1,
    "name": {
      "es": "La Brujita",
      "en": "The Little Witch"
    },
    "filename": "01.png"
  },
  {
    "id": 2,
    "name": {
      "es": "El Vampiro",
      "en": "The Vampire"
    },
    "filename": "02.png"
  }
]
```

**Structure:**
- `id`: number - Unique character identifier (unchanged)
- `name`: object - Language-keyed character names
  - `es`: string - Spanish character name
  - `en`: string - English character name
- `filename`: string - Image filename (unchanged)

### 3. Christmas Characters Data (`src/data/christmas-characters.json`)

Same structure as Halloween characters:

```json
[
  {
    "id": 1,
    "name": {
      "es": "Santa Claus",
      "en": "Santa Claus"
    },
    "filename": "01.png"
  },
  {
    "id": 2,
    "name": {
      "es": "El Reno",
      "en": "The Reindeer"
    },
    "filename": "02.png"
  }
]
```

## Implementation Plan

### Phase 1: Update Data Files
1. Update `src/data/products.json` with nested language objects
2. Update `src/data/characters.json` with nested language objects
3. Update `src/data/christmas-characters.json` with nested language objects

### Phase 2: Update Page Logic
1. Update Spanish pages (`src/pages/es/*.astro`):
   - Access `product.name.es` instead of `product.name`
   - Access `product.price.es.amount` and `product.price.es.currency`
   - Access `character.name.es` for character names

2. Update English pages (`src/pages/en/*.astro`):
   - Access `product.name.en` instead of `product.name`
   - Access `product.price.en.amount` and `product.price.en.currency`
   - Access `character.name.en` for character names

### Phase 3: Add Helper Functions (Optional)
Create utility functions in `src/utils/i18n.ts` to simplify data access:

```typescript
export function getProductName(product: Product, lang: keyof typeof ui) {
  return product.name[lang];
}

export function getProductPrice(product: Product, lang: keyof typeof ui) {
  return product.price[lang];
}

export function getCharacterName(character: Character, lang: keyof typeof ui) {
  return character.name[lang];
}
```

## Code Changes Required

### Files to Update:

1. **Data Files (3 files):**
   - `src/data/products.json`
   - `src/data/characters.json`
   - `src/data/christmas-characters.json`

2. **Spanish Pages (3 files):**
   - `src/pages/es/index.astro` - Product card names
   - `src/pages/es/halloween.astro` - Product data and character names
   - `src/pages/es/christmas.astro` - Product data and character names

3. **English Pages (3 files):**
   - `src/pages/en/index.astro` - Product card names
   - `src/pages/en/halloween.astro` - Product data and character names
   - `src/pages/en/christmas.astro` - Product data and character names

### Specific Changes in Pages:

**Before:**
```typescript
const halloweenProduct = productsData.find((p) => p.id === "halloween");
const formattedPrice = `$${halloweenProduct?.price} ${halloweenProduct?.currency}`;
```

**After (Spanish):**
```typescript
const halloweenProduct = productsData.find((p) => p.id === "halloween");
const priceData = halloweenProduct?.price.es;
const formattedPrice = `$${priceData?.amount} ${priceData?.currency}`;
```

**After (English):**
```typescript
const halloweenProduct = productsData.find((p) => p.id === "halloween");
const priceData = halloweenProduct?.price.en;
const formattedPrice = `$${priceData?.amount} ${priceData?.currency}`;
```

**Character Display (Before):**
```jsx
<div>{character.name}</div>
```

**Character Display (After - Spanish):**
```jsx
<div>{character.name.es}</div>
```

**Character Display (After - English):**
```jsx
<div>{character.name.en}</div>
```

## Pricing Strategy

### Initial Pricing:
- **Spanish (MXN):** $120 MXN for both products
- **English (USD):** $15 USD for both products

### Future Considerations:
- Easy to adjust pricing per market
- Can add more currency options (CAD, EUR, etc.)
- Can implement dynamic exchange rates if needed

## Character Translations

### Halloween Characters (24 total):
All 24 Halloween characters need Spanish and English names.

### Christmas Characters (24 total):
All 24 Christmas characters need Spanish and English names.

### Translation Guidelines:
1. Keep character names culturally appropriate
2. Maintain the playful, family-friendly tone
3. Use "The" prefix in English where appropriate (e.g., "The Little Witch")
4. Some names may be the same in both languages (e.g., "Santa Claus")

## Testing Checklist

- [ ] Products display correct names in Spanish pages
- [ ] Products display correct names in English pages
- [ ] Products display correct prices in Spanish pages (MXN)
- [ ] Products display correct prices in English pages (USD)
- [ ] Halloween character names display correctly in Spanish
- [ ] Halloween character names display correctly in English
- [ ] Christmas character names display correctly in Spanish
- [ ] Christmas character names display correctly in English
- [ ] Language switcher maintains correct data context
- [ ] No undefined or null values in production

## Rollback Plan

If issues arise, revert data files to simple structure and update pages to use direct properties. The git history will maintain the previous versions.

## Future Enhancements

1. **Dynamic Currency Conversion:** Use exchange rate API for real-time pricing
2. **More Languages:** Add FR, DE, or other languages
3. **Regional Variants:** Support regional Spanish variants (ES-MX, ES-ES, etc.)
4. **CMS Integration:** Move data to headless CMS for easier management
5. **Type Safety:** Add TypeScript interfaces for data structures
